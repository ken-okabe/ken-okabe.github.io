 

**Multilingual Setup Manual for Starlight (en/ja)**

This document outlines the manual configurations needed to enable English and Japanese language support in your Astro Starlight project.

**Prerequisites:**

Clean up under src/content/doc

1.  Your Astro project with Starlight (`@astrojs/starlight`) installed.
2.  Dependencies for your Node.js script installed (e.g., `fs-extra`, `gray-matter`, etc.).
3.  Your English source documents are located in a directory (e.g., `_book-en/`). 
4.  You will create a similar directory for Japanese source documents (e.g., `_book-ja/`).

**Step 1: Configure `astro.config.mjs`**

This is the main configuration file for your Astro project and Starlight. You'll define your site's languages and how Starlight should handle them here.

-   **File:** `astro.config.mjs` (in your project root)
-   **Action:** Modify the Starlight integration settings.

<!-- end list -->

JavaScript

```
// astro.config.mjs

import { defineConfig } from 'astro/config';
import starlight from '@astrojs/starlight';

// Import paths for sidebars that will be generated by your Node.js script.
// Ensure these paths match where your script will output the sidebar files.
// For example, if your script generates 'astro.sidebar.en.ts' and 'astro.sidebar.ja.ts' in the root.
import enSidebar from './astro.sidebar.en'; // Will be generated for English content
// import jaSidebar from './astro.sidebar.ja'; // Uncomment when Japanese content and sidebar are ready

export default defineConfig({
  integrations: [
    starlight({
      // General site title (can be overridden per locale if needed, but often set in default language)
      title: 'My Awesome Documentation',

      // Set English as the default language for the site.
      defaultLocale: 'en',

      // Define the locales (languages) your site supports.
      locales: {
        // English configuration
        en: {
          label: 'English',    // Label for the language picker
          lang: 'en',          // HTML lang attribute value
          sidebar: enSidebar,  // Assign the imported English sidebar
        },
        // Japanese configuration
        ja: {
          label: '日本語',     // Label for the language picker (Japanese)
          lang: 'ja',          // HTML lang attribute value
          // sidebar: jaSidebar, // Assign the imported Japanese sidebar (uncomment when ready)
          // If Japanese UI strings are significantly different or need custom overrides,
          // Starlight will also look for translations in `src/content/i18n/ja.json`.
        },
        // You can add more languages here in the future.
      },

      // Optional: Add other global Starlight configurations here, for example:
      // social: {
      //   github: 'https://github.com/your-org/your-repo',
      // },
      // editLink: {
      //   baseUrl: 'https://github.com/your-org/your-repo/edit/main/',
      // },
    }),
  ],
});

```

**Step 2: Prepare Japanese Source Content (`_book-ja/`)**

Your Node.js script will process source Markdown files. While it handles copying and frontmatter for `_book-en/` to `src/content/docs/en/`, you need to manually prepare the Japanese source content.

-   **Action:** Create a new directory, for example `_book-ja/`, in your project root.
-   **Content:**
    -   This directory should mirror the structure of your `_book-en/` directory.
    -   Translate all your English Markdown files (`.md`) into Japanese and place them in the corresponding locations within `_book-ja/`.
    -   If you use `_label.md` files in `_book-en/` to define sidebar group titles (as your script suggests), create corresponding `_label.md` files in `_book-ja/` with Japanese H1 titles.

**Example structure:**

```
_book-en/
  ├── unit-0/
  │   ├── _label.md         (e.g., # Unit Zero)
  │   └── 0-about-unit.md
  └── unit-1/
      ├── _label.md         (e.g., # Unit One)
      └── some-topic.md

_book-ja/                 <-- You create and populate this
  ├── unit-0/
  │   ├── _label.md         (e.g., # ユニットゼロ)
  │   └── 0-about-unit.md   (Translated content)
  └── unit-1/
      ├── _label.md         (e.g., # ユニットワン)
      └── some-topic.md     (Translated content)

```

**Step 3: Manage UI Translations (Optional but Recommended for Japanese)**

Starlight comes with built-in translations for its UI elements (e.g., "On this page", "Search"). However, you might want to provide your own or customize them, especially for Japanese.

-   **File for Japanese UI:** `src/content/i18n/ja.json`
-   **File for English UI (if overriding defaults):** `src/content/i18n/en.json`
-   **Action:** Create/edit these JSON files. The keys should be Starlight's default UI keys.

**Example `src/content/i18n/ja.json`:**

JSON

```
{
  "skipLink.label": "コンテンツにスキップ",
  "search.label": "検索",
  "search.placeholder": "検索...",
  "custom.myKey": "私のカスタム翻訳" // Example of adding a custom key
  // Add other keys you want to translate or override from Starlight's defaults.
  // You can find default keys here: https://starlight.astro.build/guides/i18n/#translate-starlights-ui
}

```

-   Ensure Content Collection is Configured (if not default):
    
    For Starlight to pick up your i18n JSON files, the i18n content collection should be defined in src/content/config.ts (or src/content/config.js). Starlight often handles this by default, but it's good to verify.
    
    -   **File:** `src/content/config.ts` (or `.js`)
    -   **Action:** Ensure the `i18n` collection is defined.
    
    <!-- end list -->
    
    TypeScript
    
    ```
    // src/content/config.ts
    import { defineCollection, z } from 'astro:content';
    import { docsSchema, i18nSchema } from '@astrojs/starlight/schema';
    
    export const collections = {
      // Defines the 'docs' collection using Starlight's schema.
      docs: defineCollection({ schema: docsSchema() }),
      // Defines the 'i18n' collection for UI translations.
      // This allows you to store JSON translation files in `src/content/i18n/`.
      i18n: defineCollection({ type: 'data', schema: i18nSchema() }),
    };
    
    ```
    

**Step 4: Verify Output Directory Structure**

Your Node.js script will create and populate these directories. This is just for your awareness of the final structure Starlight uses.

-   `src/content/docs/en/` (for English Markdown files)
-   `src/content/docs/ja/` (for Japanese Markdown files)

No direct manual file editing is usually needed here _after_ the script runs, but you should ensure these paths match what's configured in `astro.config.mjs` for the `locales` and what your script uses as output directories.

**Step 5: Running Your Node.js Script**

While the script modification itself is separate, its usage is part of this manual workflow. You'll need to run it for each language.

-   **Action (Example):**
    -   For English: `TARGET_LANG=en node your-script-name.js`
    -   For Japanese (once `_book-ja/` is ready): `TARGET_LANG=ja node your-script-name.js`

This will populate `src/content/docs/en/` and `src/content/docs/ja/` respectively, and generate `astro.sidebar.en.ts` and `astro.sidebar.ja.ts` (or similarly named files based on your script's adaptation).

 